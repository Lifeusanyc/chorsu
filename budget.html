<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Real Balans Hisobi</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
      text-align: center;
    }
    .time {
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    .balance {
      font-size: 2em;
      margin-bottom: 20px;
      font-weight: bold;
    }
    ul {
      list-style-type: none;
      padding: 0;
      max-width: 600px;
      margin: 0 auto;
      text-align: left;
    }
    li {
      background: #fff;
      padding: 8px 12px;
      margin-bottom: 5px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <div class="time" id="currentTime"></div>
  <div class="balance" id="currentBalance"></div>
  <h3>So‘nggi 10 ta balans holati:</h3>
  <ul id="historyList"></ul>

  <script>
    const points = [
      { date: new Date("2023-04-04T00:00:00"), value: 0 },
      { date: new Date("2024-04-04T00:00:00"), value: 120000 },
      { date: new Date("2025-04-04T00:00:00"), value: 280000 },
    ];

    const history = [];

    function getInterpolatedBalance(now) {
      for (let i = 0; i < points.length - 1; i++) {
        const a = points[i];
        const b = points[i + 1];

        if (now >= a.date && now <= b.date) {
          const totalTime = b.date - a.date;
          const elapsed = now - a.date;
          const ratio = elapsed / totalTime;
          return a.value + ratio * (b.value - a.value);
        }
      }
      return now < points[0].date ? 0 : points[points.length - 1].value;
    }

    function formatCurrency(val) {
      return Math.round(val).toLocaleString('uz-UZ') + " so‘m";
    }

    function formatTime(date) {
      return date.toLocaleString('uz-UZ');
    }

    function update() {
      const now = new Date();
      const balance = getInterpolatedBalance(now);
      
      document.getElementById("currentTime").textContent = "Hozirgi vaqt: " + formatTime(now);
      document.getElementById("currentBalance").textContent = "Balans: " + formatCurrency(balance);

      history.unshift({
        time: formatTime(now),
        balance: formatCurrency(balance)
      });

      if (history.length > 10) history.pop();

      const list = document.getElementById("historyList");
      list.innerHTML = history.map(item => `<li><strong>${item.time}</strong> — ${item.balance}</li>`).join('');
    }

    update();
    setInterval(update, 1000);
  </script>
</body>
</html>
