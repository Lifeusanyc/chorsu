<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Real Vaqtdagi Balans</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f0f0;
      text-align: center;
      padding: 30px;
    }
    .time, .balance {
      font-size: 1.5em;
      margin: 10px 0;
    }
    ul {
      list-style: none;
      padding: 0;
      max-width: 600px;
      margin: auto;
      text-align: left;
    }
    li {
      background: #fff;
      margin: 5px 0;
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h2>Real vaqtli balans o‘sishi</h2>
  <div class="time" id="currentTime"></div>
  <div class="balance" id="currentBalance"></div>
  <h3>So‘nggi 10 ta holat:</h3>
  <ul id="historyList"></ul>

  <script>
    const startDate = new Date("2023-04-04T00:00:00");
    const middleDate = new Date("2024-04-04T00:00:00");
    const endDate = new Date("2025-04-04T00:00:00");

    const startValue = 0;          // 2023-04-04
    const middleValue = 1200000000;    // 2024-04-04
    const endValue = 2400000000;       // 2025-04-04

    const history = [];

    // Balansni hisoblash (real vaqtga nisbatan)
    function calculateBalance(now) {
      let balance;

      if (now < startDate) return 0; // 2023-04-04 dan oldingi vaqt
      if (now >= endDate) return endValue; // 2025-04-04 dan keyin

      // 2023-04-04 dan 2024-04-04 gacha chiziqli o‘sish
      if (now < middleDate) {
        const progress = (now - startDate) / (middleDate - startDate);
        balance = startValue + (progress * (middleValue - startValue));
      } else {
        // 2024-04-04 dan 2025-04-04 gacha chiziqli o‘sish
        const progress = (now - middleDate) / (endDate - middleDate);
        balance = middleValue + (progress * (endValue - middleValue));
      }
      return balance;
    }

    // Balansni dollar va sentlarda formatlash
    function formatCurrency(val) {
      const dollars = Math.floor(val);
      const cents = Math.round((val - dollars) * 100);
      return `${dollars.toLocaleString('en-US')}.${cents.toString().padStart(2, '0')} $`;
    }

    // Sana formatlash
    function formatTime(date) {
      return date.toLocaleString('uz-UZ');
    }

    // Yangilash
    function update() {
      const now = new Date();
      const balance = calculateBalance(now);

      document.getElementById("currentTime").textContent = "Vaqt: " + formatTime(now);
      document.getElementById("currentBalance").textContent = "Balans: " + formatCurrency(balance);

      history.unshift({
        time: formatTime(now),
        balance: formatCurrency(balance)
      });

      if (history.length > 10) history.pop();

      const list = document.getElementById("historyList");
      list.innerHTML = history.map(item => `<li><strong>${item.time}</strong> — ${item.balance}</li>`).join('');
    }

    update();
    setInterval(update, 1000);
  </script>
</body>
</html>
